{
	"name": "pss_to_aggregates",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "AzureDataLakeStorage1",
						"type": "LinkedServiceReference"
					},
					"name": "pss"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureDataLakeStorage1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "aggregates"
				}
			],
			"scriptLines": [
				"source(output(",
				"          dat_quest as integer,",
				"          countryCode as integer,",
				"          begin_date_local as string,",
				"          dat_created_local as string,",
				"          device_type as string,",
				"          os_name as string,",
				"          os_version as string,",
				"          browser_name as string,",
				"          user_agent as string,",
				"          cap_activity_id as string,",
				"          userinput_vin as string,",
				"          bpnumber as string,",
				"          pz_area as string,",
				"          pz_region_pss as integer,",
				"          userinput_model_and_type as string,",
				"          model_descr as string,",
				"          userinput_lh_modelcode as integer,",
				"          userinput_lh_modelcodeDescription as string,",
				"          engine_type as string,",
				"          userinput_model_year as integer,",
				"          userinput_dlrno as integer,",
				"          userinput_bp_salesperson as integer,",
				"          userinput_salesp_fn as string,",
				"          userinput_status as integer,",
				"          userinput_delivery_date as string,",
				"          used_vehicle_delivery_date as string,",
				"          Q260 as integer,",
				"          Q270 as integer,",
				"          Q285 as integer,",
				"          Q301 as integer,",
				"          Q305 as integer,",
				"          Q303 as integer,",
				"          Q2501 as integer,",
				"          Q341 as integer,",
				"          Q342 as integer,",
				"          Q343 as integer,",
				"          Q344 as integer,",
				"          Q345 as string,",
				"          Q346 as integer,",
				"          Q347 as integer,",
				"          Q348 as integer,",
				"          Q349 as integer,",
				"          Q2901 as integer,",
				"          Q2902 as integer,",
				"          Q2903 as integer,",
				"          Q2904 as integer,",
				"          Q2905 as integer,",
				"          Q2906 as integer,",
				"          Q2907 as integer,",
				"          Q2908 as integer,",
				"          Q2909 as integer,",
				"          Q2910 as integer,",
				"          V1043 as string,",
				"          V1044 as string,",
				"          Q2921 as integer,",
				"          Q2922 as integer,",
				"          Q2923 as integer,",
				"          Q2924 as integer,",
				"          Q2925 as integer,",
				"          V1045 as string,",
				"          V1046 as string,",
				"          Q2931 as integer,",
				"          Q2932 as integer,",
				"          Q2933 as integer,",
				"          Q2934 as integer,",
				"          Q2935 as integer,",
				"          Q2936 as integer,",
				"          V1047 as string,",
				"          V1048 as string,",
				"          Q2941 as integer,",
				"          Q2942 as integer,",
				"          Q2943 as integer,",
				"          Q2944 as integer,",
				"          Q2945 as integer,",
				"          Q2946 as integer,",
				"          Q2947 as integer,",
				"          V1049 as string,",
				"          V1050 as string,",
				"          Q2951 as integer,",
				"          Q2952 as integer,",
				"          Q2953 as integer,",
				"          Q2954 as integer,",
				"          Q2955 as string,",
				"          V1051 as string,",
				"          V1052 as string,",
				"          Q2961 as integer,",
				"          Q2962 as integer,",
				"          Q2963 as integer,",
				"          Q2964 as integer,",
				"          Q2965 as integer,",
				"          Q2966 as integer,",
				"          Q2967 as integer,",
				"          Q2968 as integer,",
				"          V1053 as string,",
				"          V1054 as string,",
				"          Q2981 as integer,",
				"          Q2982 as integer,",
				"          Q2983 as integer,",
				"          V1055 as string,",
				"          V1056 as string,",
				"          Q2991 as integer,",
				"          Q2992 as integer,",
				"          Q2993 as integer,",
				"          V1057 as string,",
				"          V1058 as string,",
				"          Q350 as integer,",
				"          Q370 as integer,",
				"          Q380 as integer,",
				"          Q400 as integer,",
				"          Q410 as string,",
				"          Q3140 as integer,",
				"          Q3160 as integer,",
				"          Q3180 as integer,",
				"          Q3190 as integer,",
				"          Q352 as integer,",
				"          Q353 as integer,",
				"          Q356 as string,",
				"          Q359 as string,",
				"          Q360 as integer,",
				"          Q361 as integer,",
				"          Q362 as integer,",
				"          Q3101 as integer,",
				"          Q3102 as integer,",
				"          Q3103 as integer,",
				"          Q3108 as integer,",
				"          Q3110 as integer,",
				"          V1059 as string,",
				"          V1009 as string,",
				"          Q371 as string,",
				"          Q372 as integer,",
				"          Q373 as integer,",
				"          Q374 as integer,",
				"          Q375 as string,",
				"          Q3123 as integer,",
				"          Q3125 as integer,",
				"          V1060 as string,",
				"          V1010 as string,",
				"          Q384 as integer,",
				"          Q385 as integer,",
				"          Q386 as string,",
				"          Q387 as integer,",
				"          Q3133 as integer,",
				"          Q3134 as integer,",
				"          Q3136 as integer,",
				"          V1061 as string,",
				"          V1011 as string,",
				"          Q3141 as integer,",
				"          Q3142 as integer,",
				"          Q3143 as integer,",
				"          Q3144 as integer,",
				"          Q3145 as integer,",
				"          Q3146 as integer,",
				"          Q3147 as integer,",
				"          V1062 as string,",
				"          V1063 as string,",
				"          Q401 as string,",
				"          Q402 as integer,",
				"          Q3152 as integer,",
				"          Q3153 as integer,",
				"          Q3154 as integer,",
				"          Q3155 as integer,",
				"          V1064 as string,",
				"          V1012 as string,",
				"          Q3161 as integer,",
				"          Q3162 as integer,",
				"          Q3163 as integer,",
				"          Q3164 as integer,",
				"          Q3165 as integer,",
				"          Q3166 as integer,",
				"          Q3167 as integer,",
				"          Q3168 as integer,",
				"          Q3169 as integer,",
				"          Q3170 as integer,",
				"          V1065 as string,",
				"          V1066 as string,",
				"          Q3181 as integer,",
				"          Q3182 as integer,",
				"          Q3183 as integer,",
				"          Q3184 as integer,",
				"          Q3185 as integer,",
				"          Q3186 as integer,",
				"          V1067 as string,",
				"          V1068 as string,",
				"          Q3191 as integer,",
				"          Q3192 as integer,",
				"          Q3193 as integer,",
				"          Q3194 as integer,",
				"          Q3195 as integer,",
				"          Q3196 as integer,",
				"          V1069 as string,",
				"          V1070 as string,",
				"          Q2599 as string,",
				"          Q2600 as string,",
				"          V1078 as string,",
				"          Q2595 as integer,",
				"          Q2596 as integer,",
				"          Q631 as string,",
				"          Q632 as string,",
				"          Q633 as string,",
				"          Q2539 as integer,",
				"          V1136 as string,",
				"          Q745 as integer,",
				"          Q765 as string,",
				"          Q805 as string,",
				"          Q2531 as integer,",
				"          Q2532 as integer,",
				"          Q2521 as integer,",
				"          Q2543 as string,",
				"          Q2547 as string,",
				"          Q2557 as string,",
				"          Q2551 as string,",
				"          Q2549 as string,",
				"          Q2553 as string,",
				"          Q2523 as integer,",
				"          Q2555 as string,",
				"          Q2545 as integer,",
				"          Q2525 as integer,",
				"          Q2575 as string,",
				"          Q2561 as string,",
				"          Q2563 as string,",
				"          Q2559 as string,",
				"          Q2565 as integer,",
				"          Q2567 as string,",
				"          Q2527 as integer,",
				"          Q2569 as string,",
				"          Q2571 as string,",
				"          Q2573 as string,",
				"          Q2597 as integer,",
				"          V1025 as string,",
				"          Q2592 as string,",
				"          Q2598 as integer,",
				"          Q2594 as string,",
				"          Q2590 as integer,",
				"          V1072 as string,",
				"          Q803 as integer,",
				"          Q806 as integer,",
				"          Q3701 as string,",
				"          Q3702 as string,",
				"          V1129 as string,",
				"          V1130 as string,",
				"          Q3703 as string,",
				"          V1131 as string,",
				"          V1132 as string,",
				"          Q804 as string,",
				"          Q2652 as string,",
				"          Q2653 as string,",
				"          V1021 as string,",
				"          V1022 as string,",
				"          V1023 as string,",
				"          Q670 as integer,",
				"          Q671 as integer,",
				"          Q671Description as string,",
				"          Q676 as integer,",
				"          Q676Description as string,",
				"          Q681 as integer,",
				"          Q681Description as string,",
				"          Q686 as integer,",
				"          Q686Description as string,",
				"          Q691 as integer,",
				"          Q691Description as string,",
				"          Q696 as integer,",
				"          Q696Description as string,",
				"          Q678 as string,",
				"          Q688 as string,",
				"          Q698 as string,",
				"          V1024 as string,",
				"          Q711 as integer,",
				"          Q713 as integer,",
				"          Q713Description as string,",
				"          Q719269 as integer,",
				"          Q719Description as string,",
				"          Q719271 as integer,",
				"          Q722 as integer,",
				"          Q723 as integer,",
				"          Q725 as integer,",
				"          Q1950 as integer,",
				"          Q1951 as integer,",
				"          Q1961 as integer,",
				"          Q1961Description as string,",
				"          Q1966 as integer,",
				"          Q1966Description as string,",
				"          Q1971 as integer,",
				"          Q1971Description as string,",
				"          Q1976 as integer,",
				"          Q1976Description as string,",
				"          Q1981 as integer,",
				"          Q1981Description as string,",
				"          Q1986 as integer,",
				"          Q1986Description as string,",
				"          Q2001 as integer,",
				"          Q2011 as integer,",
				"          Q2021 as integer,",
				"          Q1701 as integer,",
				"          Q1711 as integer,",
				"          Q1721 as integer,",
				"          Q1731 as integer,",
				"          Q1734 as integer,",
				"          Q1733 as integer,",
				"          Q2696 as integer,",
				"          Q2601 as integer,",
				"          V1032 as string,",
				"          Q1903 as integer,",
				"          Q2611 as string,",
				"          Q831 as string,",
				"          Q832 as string,",
				"          Q833 as string,",
				"          Q841 as string,",
				"          Q883 as string,",
				"          V1028 as string,",
				"          Q1651 as integer,",
				"          Q1652 as integer",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'delimited',",
				"     fileSystem: 'test-data',",
				"     columnDelimiter: ';',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> pss",
				"pss aggregate({Gender Sum} = sum(Q1651)) ~> aggregates",
				"aggregates sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'json',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}